==============================================================================
                    PORKCHOP RPG LEVELING SYSTEM - IMPLEMENTATION PLAN
==============================================================================

Created: 2024-12-09
Status: COMPLETE

--[ PHASE 1: Core XP Engine ]------------------------------------------------

Files created:
  - src/core/xp.h
  - src/core/xp.cpp

Features:
  [x] PorkXPData struct definition (40 bytes NVS storage)
  [x] XP::init() - Load from NVS on boot
  [x] XP::save() - Persist to NVS
  [x] XP::addXP(XPEvent) - Add XP with event type
  [x] XP::getLevel() - Get current level
  [x] XP::xpForLevel() - Calculate XP needed for level
  [x] XP::getProgress() - 0.0-1.0 progress to next level
  [x] XP::getTitle() - Get current rank title string
  [x] XP::unlockAchievement(ach) - Set achievement bit
  [x] XP::hasAchievement(ach) - Check achievement bit
  [x] Level-up detection with callback system

Constants defined:
  [x] 40 rank titles (SCRIPT PIGGY -> LEGENDARY PORKCHOP)
  [x] Exponential XP formula
  [x] 16 achievements as bitflags
  [x] XP values for each event type

NVS storage:
  [x] "porkxp" namespace
  [x] Keys: xp, lvl, hi_hs, hi_net, hi_km, ach

--[ PHASE 2: UI Layout Adjustment ]------------------------------------------

NO CHANGES NEEDED!

Current layout analysis:
  - MAIN_H = 107px
  - Pig face: y=5 to y=71 (3 lines × 22px at textSize=3)
  - Grass: y=73 to y=89 (textSize=2 = ~16px)
  - Empty space: y=89 to y=107 = 18px UNUSED
  
The XP bar fits perfectly in the existing empty space below the grass.
No need to shift pig, bubble, or grass positions.

--[ PHASE 3: XP Bar Display ]------------------------------------------------

Files modified:
  - src/ui/display.cpp
  - src/ui/display.h

Changes:
  [x] XP::drawXPBar(canvas) called after Avatar/Mood draw
  [x] XP bar format: "L## TITLE ████░░░░ ##%"
  [x] Bar positioned at y=91, fits in 18px empty space below grass
  [x] Uses COLOR_FG for text, rectangle fill for progress bar

--[ PHASE 4: XP Event Hooks ]------------------------------------------------

Files modified:
  - src/piglet/mood.cpp

XP::addXP() calls hooked into event functions:

  [x] onHandshakeCaptured()     -> +50 XP (HANDSHAKE_CAPTURED)
  [x] onNewNetwork()            -> +1 XP (NETWORK_FOUND), +3 if hidden
  [x] onDeauthSuccess()         -> +15 XP (DEAUTH_SUCCESS)
  [x] onWarhogFound()           -> +2 XP (WARHOG_LOGGED)
  [x] onPiggyBluesUpdate()      -> +2 XP (BLE_BURST)
  [x] onGPSFix()                -> +5 XP first time per session (GPS_LOCK)

Session bonuses (in xp.cpp via updateSessionTime()):
  [x] 30 min session            -> +10 XP
  [x] 60 min session            -> +25 XP
  [x] 120 min session           -> +50 XP

--[ PHASE 5: Level Up Popup ]------------------------------------------------

Files modified:
  - src/ui/display.cpp
  - src/ui/display.h
  - src/core/porkchop.cpp

Features:
  [x] XP::setLevelUpCallback() registered in porkchop.cpp init()
  [x] Display::showLevelUpPopup(level, title)
  [x] Pink filled box with black text
  [x] Shows: "* LEVEL UP! *", "Level ##", "RANK_TITLE"
  [x] Random phrase from Mood::getRandomLevelUpPhrase()
  [x] Blocks until Enter or G0 button press

--[ PHASE 6: Distance Tracking ]---------------------------------------------

Files modified:
  - src/modes/warhog.cpp

Distance tracking:
  [x] Haversine formula implemented in warhog.cpp
  [x] Accumulate GPS deltas with movement threshold (10m min)
  [x] Awards +25 XP per km walked (WARHOG_KM event)
  [x] Reset on session start

Achievement system defined in xp.h (16 bitflags):
  [x] ACH_FIRST_BLOOD   - First handshake captured
  [x] ACH_PACKET_HOG    - 100 handshakes lifetime
  [x] ACH_WARDRIVER     - 1000 networks logged
  [x] ACH_ROAD_HOG      - 10km wardriving
  [x] ACH_GHOST_HUNTER  - 50 hidden networks
  [x] ACH_CHAOS_AGENT   - 100 deauths
  [x] ACH_SESSION_GRIND - 2hr session
  [x] ACH_BLE_SPAMMER   - 500 BLE bursts

--[ PHASE 7: Documentation ]-------------------------------------------------

Files modified:
  - .github/copilot-instructions.md

Documentation added:
  [x] XP system overview in Project Overview
  [x] XP engine listed in Core Components
  [x] Display System updated with XP bar position
  [x] Complete XP System section with storage, events, ranks, achievements

==============================================================================
                              XP VALUES (IMPLEMENTED)
==============================================================================

Event                   | XP    | Trigger
------------------------|-------|------------------------------------------
Network discovered      | +1    | onNewNetwork (NETWORK_FOUND)
Hidden network          | +3    | onNewNetwork (NETWORK_HIDDEN)
Handshake captured      | +50   | onHandshakeCaptured (HANDSHAKE_CAPTURED)
Deauth success          | +15   | onDeauthSuccess (DEAUTH_SUCCESS)
WARHOG network logged   | +2    | onWarhogFound (WARHOG_LOGGED)
1 km walked             | +25   | distance threshold (WARHOG_KM)
BLE burst               | +2    | onPiggyBluesUpdate (BLE_BURST)
GPS lock acquired       | +5    | onGPSFix first time (GPS_LOCK)
Session 30 min          | +10   | updateSessionTime (SESSION_30MIN)
Session 60 min          | +25   | updateSessionTime (SESSION_1HR)
Session 120 min         | +50   | updateSessionTime (SESSION_2HR)

==============================================================================
                         RANK TITLES (40 LEVELS - IMPLEMENTED)
==============================================================================

Exponential XP curve using formula: base * (1.15 ^ (level-1))

LV  | Title                  | Notes
----|------------------------|----------------------------------------
1   | SCRIPT PIGGY           | Starting rank
2   | BACON BIT              | First levelups are quick
3   | SQUEALING NOOB         |
4   | PIGPEN CURIOUS         |
5   | SLOP BUCKET SURFER     |
6   | TROUGH DIVER           |
7   | MUD DAUBER             |
8   | SNOUT POKER            |
9   | CURLY TAIL CODER       |
10  | PIGLET PROBER          |
11  | OINKER OPERATIVE       |
12  | PORK PILOT             |
13  | SAUSAGE LINKER         |
14  | HOG HANDLER            |
15  | BOAR BORER             |
16  | SWINE SWINDLER         |
17  | ROOTER ELITE           |
18  | SNORT SPECIALIST       |
19  | HAMBONE HACKER         |
20  | BRISTLE BREACHER       |
21  | OINK-SEC ENGINEER      |
22  | SNOUT SNIFFER PRO      |
23  | PORK BARREL HACKER     |
24  | TRUFFLE HUNTER         |
25  | SWINE DEBUGGER         |
26  | HAM SANDWICH ARTIST    |
27  | PORKCHOP OPERATOR      |
28  | MASTER SWINEHERD       |
29  | OINK OVERLORD          |
30  | BARON VON BACON        |
31  | SQUEALER SUPREME       | High levels take weeks
32  | GRANDMASTER GROINKER   |
33  | PORCINE PENETRATOR     |
34  | LEGENDARY SNORTER      |
35  | MYTHIC MUDWALLOWER     |
36  | APEX APORKALYPSE       |
37  | DIVINE SWINEHERD       |
38  | COSMIC PORKCHOP        |
39  | ETERNAL OINKER         |
40  | LEGENDARY PORKCHOP     | Final rank - months of grinding

==============================================================================
                              IMPLEMENTATION PROGRESS
==============================================================================

Phase 1: Core XP Engine         [x] COMPLETE - xp.h/xp.cpp created
Phase 2: UI Layout Adjustment   [x] COMPLETE - No changes needed (fits in empty space)
Phase 3: XP Bar Display         [x] COMPLETE - drawXPBar() at y=91
Phase 4: XP Event Hooks         [x] COMPLETE - All Mood handlers trigger XP
Phase 5: Level Up Popup         [x] COMPLETE - showLevelUpPopup() with callback
Phase 6: Distance Tracking      [x] COMPLETE - Haversine formula in warhog.cpp
Phase 7: Documentation          [x] COMPLETE - copilot-instructions.md updated

All phases complete! Build RAM: 18.6%, Flash: 42.5%

==[EOF]==
